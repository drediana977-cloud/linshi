<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä»»åŠ¡ç®¡ç†å™¨ + è®¡æ—¶ + ç§‘å­¦è®¡ç®— + ç»´å¤šåˆ©äºšåŸ</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            padding: 40px 20px 120px;
        }
        .container { width: 100%; max-width: 900px; }
        .header { text-align: center; margin-bottom: 20px; color: white; }
        .header h1 { font-size: 2.3rem; font-weight: 700; text-shadow: 0 2px 4px rgba(0,0,0,0.2); }
        .header p { font-size: 1rem; opacity: 0.85; margin-top: 8px; }

        .layout { display: grid; grid-template-columns: 2fr 1.2fr; gap: 20px; }
        @media (max-width: 800px) { .layout { grid-template-columns: 1fr; } }

        .card {
            background: white;
            border-radius: 20px;
            padding: 24px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.2);
        }

        /* ä»»åŠ¡ç®¡ç†å™¨ */
        .input-group { display: flex; gap: 12px; margin-bottom: 18px; }
        .input-group input {
            flex: 1; padding: 12px 16px; border: 2px solid #e8e8e8;
            border-radius: 12px; font-size: 1rem; outline: none;
            transition: border-color 0.3s; color: #333;
        }
        .input-group input:focus { border-color: #667eea; }
        .btn-add {
            padding: 12px 18px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white; border: none; border-radius: 12px;
            font-size: 1.4rem; cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 4px 15px rgba(102,126,234,0.4);
        }
        .btn-add:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(102,126,234,0.5); }

        .stats { display: flex; gap: 10px; margin-bottom: 14px; }
        .stat { flex: 1; text-align: center; padding: 10px; background: #f8f9ff; border-radius: 12px; }
        .stat-number { font-size: 1.5rem; font-weight: 700; color: #667eea; }
        .stat-label { font-size: 0.75rem; color: #999; margin-top: 2px; }

        .filters { display: flex; gap: 8px; margin-bottom: 14px; }
        .filter-btn {
            flex: 1; padding: 8px; border: 2px solid #e8e8e8; border-radius: 10px;
            background: transparent; font-size: 0.85rem; cursor: pointer;
            transition: all 0.3s; color: #666; font-weight: 500;
        }
        .filter-btn.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-color: transparent; color: white;
        }

        .task-list { list-style: none; }
        .task-item {
            display: grid;
            grid-template-columns: auto 1fr auto;
            grid-template-rows: auto auto;
            grid-column-gap: 10px; grid-row-gap: 4px;
            padding: 10px 12px; border-radius: 12px;
            margin-bottom: 8px; background: #f8f9ff;
            transition: all 0.3s; animation: slideIn 0.3s ease; align-items: center;
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .task-item.completed { opacity: 0.6; }

        .task-checkbox {
            width: 20px; height: 20px; border: 2px solid #ccc;
            border-radius: 50%; cursor: pointer; display: flex;
            align-items: center; justify-content: center; flex-shrink: 0;
            transition: all 0.3s; grid-row: 1 / span 2;
        }
        .task-item.completed .task-checkbox {
            background: linear-gradient(135deg, #667eea, #764ba2); border-color: transparent;
        }
        .task-item.completed .task-checkbox::after {
            content: 'âœ“'; color: white; font-size: 12px; font-weight: bold;
        }

        .task-text { font-size: 0.95rem; color: #333; word-break: break-word; }
        .task-item.completed .task-text { text-decoration: line-through; color: #999; }

        .task-meta { display: flex; align-items: center; gap: 10px; font-size: 0.75rem; color: #999; }
        .task-time { white-space: nowrap; }

        .btn-delete {
            background: none; border: none; cursor: pointer; font-size: 1.1rem;
            opacity: 0; transition: opacity 0.3s; color: #ff6b6b;
            padding: 4px; grid-row: 1 / span 2;
        }
        .task-item:hover .btn-delete { opacity: 1; }

        .task-timer { display: inline-flex; align-items: center; gap: 6px; font-size: 0.8rem; color: #667eea; }
        .task-timer button {
            border-radius: 20px; border: none; padding: 3px 8px;
            font-size: 0.72rem; cursor: pointer;
            background: #e0e4ff; color: #4b5bd5;
        }

        .empty-state { text-align: center; padding: 24px 10px; color: #bbb; }
        .empty-state .icon { font-size: 2.2rem; margin-bottom: 8px; }

        .clear-btn {
            width: 100%; margin-top: 10px; padding: 10px;
            background: none; border: 2px dashed #e8e8e8;
            border-radius: 12px; cursor: pointer; color: #bbb;
            font-size: 0.85rem; transition: all 0.3s;
        }
        .clear-btn:hover { border-color: #ff6b6b; color: #ff6b6b; }

        /* é€šç”¨è®¡æ—¶å™¨ */
        .timer-section h3 { font-size: 1rem; margin-bottom: 6px; color: #333; }
        .timer-display { font-size: 1.4rem; font-weight: 600; color: #667eea; margin-bottom: 8px; }
        .timer-controls { display: flex; gap: 6px; flex-wrap: wrap; margin-bottom: 10px; }
        .timer-controls button {
            flex: 1; min-width: 70px; padding: 6px 8px; border-radius: 8px;
            border: none; cursor: pointer; font-size: 0.8rem;
            background: #f3f4ff; color: #4b5bd5;
        }
        .timer-controls button.danger { background: #ffe5e5; color: #e35151; }
        .countdown-input {
            width: 100%; padding: 6px 8px; border-radius: 8px;
            border: 1px solid #e0e0e0; font-size: 0.85rem; margin-bottom: 6px;
        }

        /* ç§‘å­¦è®¡ç®—å™¨ */
        .calc { margin-top: 14px; }
        .calc-title { font-size: 1rem; margin-bottom: 6px; color: #333; }
        .calc-display {
            width: 100%; padding: 8px 10px; border-radius: 10px;
            border: 1px solid #e0e0e0; margin-bottom: 6px; font-size: 0.9rem;
        }
        .calc-small { font-size: 0.7rem; color: #999; margin-bottom: 4px; }
        .calc-buttons { display: grid; grid-template-columns: repeat(5, 1fr); gap: 6px; }
        .calc-buttons button {
            padding: 8px; font-size: 0.85rem; border-radius: 8px;
            border: none; cursor: pointer; background: #f4f4ff; color: #333;
        }
        .calc-buttons button.op { background: #e2e6ff; color: #4b5bd5; }
        .calc-buttons button.fn { background: #ffe9d6; color: #cc6b29; }
        .calc-buttons button.equal { background: #4caf50; color: white; }
        .calc-buttons button.clear { background: #ff6b6b; color: white; }
        .calc-history {
            margin-top: 6px; max-height: 90px; overflow-y: auto;
            font-size: 0.75rem; border-top: 1px dashed #eee;
            padding-top: 4px; color: #666;
        }
        .calc-history div { margin-bottom: 2px; }

        /* å¨±ä¹å…¥å£å¡ç‰‡ */
        .fun-entry {
            margin-top: 20px;
            background: white;
            border-radius: 20px;
            padding: 20px 24px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 16px;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .fun-entry:hover { transform: translateY(-3px); }
        .fun-entry-left { display: flex; align-items: center; gap: 14px; }
        .fun-entry-icon { font-size: 2.2rem; }
        .fun-entry-text h3 { font-size: 1.1rem; color: #333; margin-bottom: 4px; }
        .fun-entry-text p { font-size: 0.85rem; color: #999; }
        .fun-entry-arrow {
            font-size: 1.5rem; color: #667eea;
            background: #f0f2ff;
            border-radius: 50%;
            width: 40px; height: 40px;
            display: flex; align-items: center; justify-content: center;
        }
        .fun-badge {
            background: linear-gradient(135deg, #ff6b9d, #ff9f7a);
            color: white;
            border-radius: 20px;
            font-size: 0.7rem;
            padding: 2px 10px;
            font-weight: 600;
        }

        /* å­ç½‘é¡µ Modal */
        .subpage-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.35s;
        }
        .subpage-overlay.open { opacity: 1; pointer-events: all; }
        .subpage {
            background: white;
            width: 100%;
            max-width: 880px;
            max-height: 90vh;
            border-radius: 24px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            transform: translateY(60px) scale(0.96);
            transition: transform 0.35s cubic-bezier(.22,1,.36,1);
            box-shadow: 0 30px 80px rgba(0,0,0,0.3);
        }
        .subpage-overlay.open .subpage { transform: translateY(0) scale(1); }

        .subpage-header {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 20px;
            background: linear-gradient(135deg, #ff6b9d, #ff9f7a);
            color: white;
        }
        .back-btn {
            background: rgba(255,255,255,0.25);
            border: none; border-radius: 20px;
            color: white; font-size: 0.85rem;
            padding: 6px 14px; cursor: pointer;
        }
        .subpage-title { font-size: 1.1rem; font-weight: 700; flex: 1; }

        .subpage-tabs {
            display: flex;
            gap: 6px;
            margin-left: auto;
        }
        .subpage-tab {
            border: none;
            border-radius: 20px;
            padding: 6px 12px;
            font-size: 0.8rem;
            cursor: pointer;
            background: rgba(255,255,255,0.25);
            color: white;
        }
        .subpage-tab.active {
            background: rgba(255,255,255,0.95);
            color: #ff6b9d;
        }

        .subpage-body {
            padding: 20px;
            overflow-y: auto;
            flex: 1;
            background: #f7f4f0;
        }

        /* è¶£å‘³æµ‹è¯„å†…éƒ¨ */
        .game-intro {
            text-align: center;
            padding: 10px 0 20px;
        }
        .big-emoji { font-size: 3.5rem; margin-bottom: 14px; }
        .game-intro h2 { font-size: 1.4rem; color: #333; margin-bottom: 10px; }
        .game-intro p { font-size: 0.9rem; color: #777; line-height: 1.6; }
        .start-btn {
            margin-top: 20px; padding: 12px 40px;
            border-radius: 50px; border: none;
            background: linear-gradient(135deg, #ff6b9d, #ff9f7a);
            color: white; font-size: 1rem; font-weight: 600;
            cursor: pointer;
            box-shadow: 0 6px 20px rgba(255,107,157,0.35);
        }

        .quiz-area { display: none; }
        .progress-bar-wrap {
            height: 6px; background: #f0f0f0;
            border-radius: 20px; margin-bottom: 20px;
        }
        .progress-bar {
            height: 6px; border-radius: 20px;
            background: linear-gradient(90deg, #ff6b9d, #ff9f7a);
            transition: width 0.5s;
        }
        .question-num { font-size: 0.82rem; color: #aaa; margin-bottom: 6px; }
        .question-text { font-size: 1.1rem; color: #333; font-weight: 600; margin-bottom: 18px; line-height: 1.6; }
        .options { display: flex; flex-direction: column; gap: 10px; }
        .opt-btn {
            padding: 12px 16px;
            border-radius: 12px;
            border: 2px solid #e8e8e8;
            background: white;
            text-align: left;
            font-size: 0.95rem;
            color: #444;
            cursor: pointer;
            transition: all 0.2s;
        }
        .opt-btn:hover {
            border-color: #ff9f7a;
            background: #fff7f3;
            color: #cc5b1a;
        }

        .result-area {
            display: none;
            text-align: center;
            padding: 10px 0;
        }
        .result-emoji { font-size: 3.5rem; margin-bottom: 12px; }
        .result-title { font-size: 1.2rem; color: #444; margin-bottom: 6px; font-weight: 700; }
        .result-size {
            font-size: 3rem;
            font-weight: 900;
            background: linear-gradient(135deg, #ff6b9d, #ff9f7a);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin: 10px 0;
        }
        .result-level {
            display: inline-block;
            padding: 6px 20px;
            border-radius: 30px;
            font-size: 0.95rem;
            font-weight: 700;
            margin-bottom: 14px;
        }
        .result-comment { font-size: 0.95rem; color: #666; line-height: 1.7; margin-bottom: 20px; }
        .formula-block {
            background: #f8f9ff;
            border-radius: 12px;
            padding: 12px;
            font-size: 0.78rem;
            color: #888;
            text-align: left;
            margin-bottom: 18px;
            line-height: 1.8;
        }
        .retry-btn {
            padding: 10px 30px;
            border-radius: 50px;
            border: none;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            font-size: 0.9rem;
            cursor: pointer;
        }

        /* ç»´å¤šåˆ©äºšåŸå¸‚æ¨¡æ‹Ÿæ¨¡å— */
        .city-wrapper {
            background: #fff;
            border-radius: 18px;
            padding: 16px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
        }
        .city-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .city-header h2 { font-size: 1.1rem; color: #333; }
        .city-era {
            font-size: 0.8rem;
            color: #999;
        }
        .city-stats {
            display: grid;
            grid-template-columns: repeat(4,1fr);
            gap: 8px;
            margin: 6px 0 6px;
            font-size: 0.8rem;
            color: #555;
        }
        .city-stat {
            background: #f8f5f0;
            border-radius: 10px;
            padding: 6px 8px;
            text-align: center;
        }
        .city-stat span { display: block; }
        .city-stat .label { font-size: 0.75rem; color: #999; }
        .city-stat .value { font-weight: 700; }

        .city-bars {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 8px;
        }
        .city-bar {
            font-size: 0.8rem;
        }
        .city-bar-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 3px;
            color: #555;
        }
        .city-bar-track {
            height: 6px;
            background: #eee;
            border-radius: 20px;
            overflow: hidden;
        }
        .city-bar-fill {
            height: 6px;
            border-radius: 20px;
            background: linear-gradient(90deg,#667eea,#31c6ff);
            width: 50%;
            transition: width 0.25s;
        }
        .city-bar-fill.red { background: linear-gradient(90deg,#ff6b6b,#ffa26f); }
        .city-bar-fill.green { background: linear-gradient(90deg,#2ecc71,#a3e635); }

        .city-actions-title {
            margin-top: 10px;
            font-size: 0.9rem;
            font-weight: 600;
            color: #444;
        }
        .city-actions {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-top: 6px;
        }
        .city-btn {
            padding: 8px 6px;
            border-radius: 10px;
            border: none;
            font-size: 0.75rem;
            cursor: pointer;
            background: #eef2ff;
            color: #3949ab;
        }
        .city-btn.red { background: #ffebee; color: #c62828; }
        .city-btn.green { background: #e8f5e9; color: #2e7d32; }
        .city-btn[disabled] {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .city-year {
            font-size: 0.8rem;
            color: #999;
            margin-top: 6px;
            text-align: right;
        }
        .city-log {
            margin-top: 8px;
            max-height: 160px;
            overflow-y: auto;
            font-size: 0.78rem;
            background: #fdfaf5;
            border-radius: 10px;
            padding: 8px;
            border: 1px dashed #e6d9c5;
        }
        .city-log-entry { margin-bottom: 4px; }

        .city-note {
            margin-top: 8px;
            font-size: 0.78rem;
            color: #777;
            line-height: 1.7;
        }
        .city-note span {
            color: #c62828;
            font-weight: 600;
        }

        .city-ending {
            margin-top: 12px;
            padding: 10px;
            border-radius: 10px;
            font-size: 0.85rem;
            background: #fff3e0;
            color: #5d4037;
            display: none;
        }

        .footer-tip {
            position: fixed;
            bottom: 8px; left: 50%;
            transform: translateX(-50%);
            color: #f5f5f5; font-size: 0.75rem; opacity: 0.9;
        }
    </style>
</head>
<body>
<div class="container">
    <div class="header">
        <h1>âœ… ä»»åŠ¡ç®¡ç†å™¨ Â· è®¡æ—¶ Â· ç§‘å­¦è®¡ç®—</h1>
        <p>ç™½å¤©æ˜¯é«˜æ•ˆä»»åŠ¡ç®¡ç†ï¼Œå¤œé‡Œæ‚„æ‚„ç©¿è¶Šåˆ°ç»´å¤šåˆ©äºšæ—¶ä»£ï¼Œå½“ä¸€å›å¸‚é•¿ã€‚</p>
    </div>

    <div class="layout">
        <!-- å·¦ï¼šä»»åŠ¡ç®¡ç†å™¨ -->
        <div class="card">
            <div class="input-group">
                <input type="text" id="taskInput" placeholder="æ·»åŠ æ–°ä»»åŠ¡ï¼ŒæŒ‰ Enter æˆ–ç‚¹å‡» ï¼‹" maxlength="100" />
                <button class="btn-add" onclick="addTask()">ï¼‹</button>
            </div>
            <div class="stats">
                <div class="stat">
                    <div class="stat-number" id="totalCount">0</div>
                    <div class="stat-label">å…¨éƒ¨</div>
                </div>
                <div class="stat">
                    <div class="stat-number" id="activeCount">0</div>
                    <div class="stat-label">è¿›è¡Œä¸­</div>
                </div>
                <div class="stat">
                    <div class="stat-number" id="completedCount">0</div>
                    <div class="stat-label">å·²å®Œæˆ</div>
                </div>
            </div>
            <div class="filters">
                <button class="filter-btn active" onclick="setFilter('all', this)">å…¨éƒ¨</button>
                <button class="filter-btn" onclick="setFilter('active', this)">è¿›è¡Œä¸­</button>
                <button class="filter-btn" onclick="setFilter('completed', this)">å·²å®Œæˆ</button>
            </div>
            <ul class="task-list" id="taskList"></ul>
            <button class="clear-btn" onclick="clearCompleted()">ğŸ—‘ æ¸…é™¤å·²å®Œæˆä»»åŠ¡</button>
        </div>

        <!-- å³ï¼šè®¡æ—¶å™¨ + è®¡ç®—å™¨ -->
        <div class="card">
            <div class="timer-section">
                <h3>â± é€šç”¨ç§’è¡¨</h3>
                <div class="timer-display" id="stopwatchDisplay">00:00:00</div>
                <div class="timer-controls">
                    <button onclick="startStopwatch()">å¼€å§‹ / ç»§ç»­</button>
                    <button onclick="pauseStopwatch()">æš‚åœ</button>
                    <button class="danger" onclick="resetStopwatch()">é‡ç½®</button>
                </div>
            </div>
            <div class="timer-section" style="margin-top:12px;">
                <h3>â³ ç®€å•å€’è®¡æ—¶</h3>
                <input type="number" id="countdownInput" class="countdown-input" placeholder="è¾“å…¥å€’è®¡æ—¶ç§’æ•°ï¼Œä¾‹å¦‚ 150" />
                <div class="timer-display" id="countdownDisplay">00:00</div>
                <div class="timer-controls">
                    <button onclick="startCountdown()">å¼€å§‹ / ç»§ç»­</button>
                    <button onclick="pauseCountdown()">æš‚åœ</button>
                    <button class="danger" onclick="resetCountdown()">é‡ç½®</button>
                </div>
            </div>
            <div class="calc">
                <div class="calc-title">ğŸ§® ç§‘å­¦è®¡ç®—å™¨</div>
                <div class="calc-small">æ”¯æŒï¼šåˆ†æ•° (1/3+2/5)ã€å¹‚ ^ã€sqrtã€sinã€cosã€tanã€lnã€log10</div>
                <input id="calcInput" class="calc-display" placeholder="è¾“å…¥è¡¨è¾¾å¼ï¼Œå¦‚ (1/2+2/3)^2" />
                <input id="calcResult" class="calc-display" placeholder="ç»“æœ" readonly />
                <div class="calc-buttons">
                    <button onclick="appendCalc('7')">7</button>
                    <button onclick="appendCalc('8')">8</button>
                    <button onclick="appendCalc('9')">9</button>
                    <button class="op" onclick="appendCalc('/')">/</button>
                    <button class="clear" onclick="clearCalc()">C</button>

                    <button onclick="appendCalc('4')">4</button>
                    <button onclick="appendCalc('5')">5</button>
                    <button onclick="appendCalc('6')">6</button>
                    <button class="op" onclick="appendCalc('*')">Ã—</button>
                    <button class="op" onclick="appendCalc('^')">^</button>

                    <button onclick="appendCalc('1')">1</button>
                    <button onclick="appendCalc('2')">2</button>
                    <button onclick="appendCalc('3')">3</button>
                    <button class="op" onclick="appendCalc('-')">-</button>
                    <button class="fn" onclick="appendCalc('sqrt(')">âˆš</button>

                    <button onclick="appendCalc('0')">0</button>
                    <button onclick="appendCalc('.')">.</button>
                    <button onclick="appendCalc('(')">(</button>
                    <button onclick="appendCalc(')')">)</button>
                    <button class="equal" onclick="calcEqual()">=</button>

                    <button class="fn" onclick="appendCalc('sin(')">sin</button>
                    <button class="fn" onclick="appendCalc('cos(')">cos</button>
                    <button class="fn" onclick="appendCalc('tan(')">tan</button>
                    <button class="fn" onclick="appendCalc('ln(')">ln</button>
                    <button class="fn" onclick="appendCalc('log10(')">log10</button>
                </div>
                <div class="calc-history" id="calcHistory"></div>
            </div>
        </div>
    </div>

    <!-- å¨±ä¹å…¥å£å¡ç‰‡ -->
    <div class="fun-entry" onclick="openFunPage()">
        <div class="fun-entry-left">
            <div class="fun-entry-icon">ğŸ®</div>
            <div class="fun-entry-text">
                <h3>å¨±ä¹æ¶ˆé£ Â· è¶£å‘³æµ‹è¯• + ç»´å¤šåˆ©äºšå¸‚é•¿ <span class="fun-badge">NEW</span></h3>
                <p>åšä¸€ä¸ªç•¥ä¸æ­£ç»çš„æµ‹è¯„ï¼Œå†è¯•ç€æŠŠä¸€åº§å·¥ä¸šåŸå¸‚å¸¦åˆ° 1901 å¹´ï¼Œçœ‹ä½ èµ°å‘å“ªç§ç»“å±€ã€‚</p>
            </div>
        </div>
        <div class="fun-entry-arrow">â†’</div>
    </div>
</div>
    <!-- Jack è¯­å½•å…¥å£ï¼šç‹¬ç«‹å…¨å±å­é¡µé¢ -->
    <a href="jack.html" style="text-decoration:none;">
        <div class="fun-entry" style="margin-top:16px; background: linear-gradient(135deg,#1e1207,#2c1005); border:1px solid rgba(201,162,39,0.3);">
            <div class="fun-entry-left">
                <div class="fun-entry-icon">â­</div>
                <div class="fun-entry-text">
                    <h3 style="color:#c9a227;">Jack è¯­å½• Â· å¿ƒç³»ç¾¤ä¼—ï¼Œå¦è¡è§å·±</h3>
                    <p style="color:rgba(201,162,39,0.55);">ç‚¹å‡»è¿›å…¥ç‹¬ç«‹å…¨å±é¡µé¢ Â· åŸåˆ›æ”¹ç¼–è¯­å½• Â· ä»ç¾¤ä¼—ä¸­æ¥ï¼Œåˆ°ç¾¤ä¼—ä¸­å»</p>
                </div>
            </div>
            <div class="fun-entry-arrow" style="background:rgba(201,162,39,0.15);color:#c9a227;">â†’</div>
        </div>
    </a>

<!-- å­ç½‘é¡µ Modal -->
<div class="subpage-overlay" id="subpageOverlay">
    <div class="subpage">
        <div class="subpage-header">
            <button class="back-btn" onclick="closeFunPage()">â† è¿”å›</button>
            <div class="subpage-title">ğŸ® è¶£å‘³æµ‹è¯„ & ç»´å¤šåˆ©äºšåŸ</div>
            <div class="subpage-tabs">
                <button class="subpage-tab active" id="tabQuiz" onclick="switchSubTab('quiz')">è¶£å‘³æµ‹è¯•</button>
                <button class="subpage-tab" id="tabCity" onclick="switchSubTab('city')">ç»´å¤šåˆ©äºšå¸‚é•¿æ¨¡æ‹Ÿ</button>
            </div>
        </div>
        <div class="subpage-body">
            <!-- Tab 1: è¶£å‘³æµ‹è¯„ -->
            <div id="subTabQuiz">
                <div class="game-intro" id="gameIntro">
                    <div class="big-emoji">ğŸ”¬</div>
                    <h2>ç§‘å­¦è¶£å‘³æµ‹è¯„</h2>
                    <p>å…± <strong>10</strong> é“é€‰æ‹©é¢˜ï¼Œçº¯å¨±ä¹å‘ã€‚<br>
                       ç»“æœé€šè¿‡ä¸€ä¸ªè™šæ„çš„ã€Œå°ºå¯¸æŒ‡æ•°ç®—æ³•ã€ç»™å‡ºï¼Œä¸å…·æœ‰ä»»ä½•ç°å®å«ä¹‰ã€‚</p>
                    <button class="start-btn" onclick="startGame()">å¼€å§‹æµ‹è¯„ ğŸš€</button>
                </div>
                <div class="quiz-area" id="quizArea">
                    <div class="progress-bar-wrap">
                        <div class="progress-bar" id="progressBar" style="width:0%"></div>
                    </div>
                    <div class="question-num" id="questionNum">ç¬¬ 1 / 10 é¢˜</div>
                    <div class="question-text" id="questionText"></div>
                    <div class="options" id="optionsArea"></div>
                </div>
                <div class="result-area" id="resultArea">
                    <div class="result-emoji" id="resultEmoji">ğŸ†</div>
                    <div class="result-title">æµ‹è¯„å®Œæˆï¼æ‚¨çš„ä¸“å±ç»“æœæ˜¯ï¼š</div>
                    <div class="result-size" id="resultSize">-- cm</div>
                    <div class="result-level" id="resultLevel"></div>
                    <div class="result-comment" id="resultComment"></div>
                    <div class="formula-block" id="formulaBlock"></div>
                    <button class="retry-btn" onclick="retryGame()">ğŸ”„ å†æµ‹ä¸€æ¬¡</button>
                </div>
            </div>

            <!-- Tab 2: ç»´å¤šåˆ©äºšåŸå¸‚æ¨¡æ‹Ÿï¼ˆå¤šç»“å±€ï¼‰ -->
            <div id="subTabCity" style="display:none;">
                <div class="city-wrapper">
                    <div class="city-header">
                        <h2>ğŸ™ ç»´å¤šåˆ©äºšåŸ Â· å¤šç»“å±€å¸‚é•¿æ¨¡æ‹Ÿ</h2>
                        <div class="city-era">çº¦ 1837 - 1901 Â· å·¥ä¸šé©å‘½ä¸å·¥äººè¿åŠ¨å¹¶è¡Œçš„æ—¶ä»£[web:69]</div>
                    </div>

                    <div class="city-stats">
                        <div class="city-stat">
                            <span class="label">äººå£</span>
                            <span class="value" id="cityPopulation">8000</span>
                        </div>
                        <div class="city-stat">
                            <span class="label">å·¥ä¸šäº§å‡º</span>
                            <span class="value" id="cityIndustry">10</span>
                        </div>
                        <div class="city-stat">
                            <span class="label">å¸‚æ”¿è´¢æ”¿ (Â£)</span>
                            <span class="value" id="cityTreasury">2000</span>
                        </div>
                        <div class="city-stat">
                            <span class="label">å¹´ä»½</span>
                            <span class="value" id="cityYear">1837</span>
                        </div>
                    </div>

                    <div class="city-bars">
                        <div class="city-bar">
                            <div class="city-bar-label">
                                <span>å·¥äººé˜¶çº§æ»¡æ„åº¦</span>
                                <span id="cityHappinessText">55 / 100</span>
                            </div>
                            <div class="city-bar-track">
                                <div class="city-bar-fill green" id="cityHappinessBar" style="width:55%"></div>
                            </div>
                        </div>
                        <div class="city-bar">
                            <div class="city-bar-label">
                                <span>å·¥ä½œæ¡ä»¶ / å®‰å…¨</span>
                                <span id="citySafetyText">40 / 100</span>
                            </div>
                            <div class="city-bar-track">
                                <div class="city-bar-fill red" id="citySafetyBar" style="width:40%"></div>
                            </div>
                        </div>
                    </div>

                    <div class="city-actions-title">åŸå¸‚å†³ç­–ï¼ˆæ¯æ¬¡å†³ç­–æ¨è¿›æ—¶é—´å¹¶å¯èƒ½è§¦å‘å†å²äº‹ä»¶ï¼‰</div>
                    <div class="city-actions">
                        <button class="city-btn" id="btnFactory" onclick="buildFactory()">å»ºè®¾çººç»‡å·¥å‚</button>
                        <button class="city-btn" onclick="expandRailway()">ä¿®å»ºé“è·¯</button>
                        <button class="city-btn green" id="btnTenHours" onclick="passTenHoursAct()">é€šè¿‡åå°æ—¶å·¥å‚æ³•</button>
                        <button class="city-btn green" onclick="improveSanitation()">æ”¹å–„å«ç”Ÿä¸ä½æˆ¿</button>
                        <button class="city-btn red" onclick="strictPoorLaw()">ä¸¥æ ¼æ‰§è¡Œæµè´«æ³•</button>
                        <button class="city-btn green" onclick="supportWorkersEdu()">èµåŠ©å·¥äººå¤œæ ¡ä¸è¯»ä¹¦ä¼š</button>
                    </div>

                    <div class="city-year" id="cityYearDesc"></div>
                    <div class="city-log" id="cityLog"></div>

                    <div class="city-ending" id="cityEnding"></div>

                    <div class="city-note">
                        è¯´æ˜ï¼šè¿™é‡Œçš„äº‹ä»¶å’Œå€¾å‘å‚è€ƒäº†ç»´å¤šåˆ©äºšæ—¶æœŸçš„é“è·¯æ‰©å¼ ã€å·¥å‚æ³•ã€æµè´«æ³•äº‰è®®ä»¥åŠæ—©æœŸå·¥äººç½¢å·¥ã€å·¥äººæ•™è‚²ä¸ç¤¾ä¼šä¸»ä¹‰/å…±äº§ä¸»ä¹‰æ€æ½®çš„èŒèŠ½ï¼Œä½†è¢«å‹ç¼©æˆè½»é‡çº§ç©æ³•ã€‚[web:63][web:69][web:78]
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="footer-tip">æç¤ºï¼šç‚¹å‡»â€œå¨±ä¹æ¶ˆé£â€å¡ç‰‡ï¼Œæ‰“å¼€æµ‹è¯„å’Œç»´å¤šåˆ©äºšå¤šç»“å±€åŸå¸‚æ¨¡æ‹Ÿã€‚</div>

<script>
/* ========= ä»»åŠ¡ & è®¡æ—¶ ========= */
let tasks = JSON.parse(localStorage.getItem('tasks_v2')) || [];
let currentFilter = 'all';
let taskTimerIntervals = {};

function saveTasks(){ localStorage.setItem('tasks_v2', JSON.stringify(tasks)); }

function addTask(){
    const input = document.getElementById('taskInput');
    const text = input.value.trim();
    if(!text) return;
    const now = new Date();
    const timeStr = String(now.getHours()).padStart(2,'0') + ':' + String(now.getMinutes()).padStart(2,'0');
    tasks.unshift({ id: Date.now(), text, completed:false, time:timeStr, spentSeconds:0, running:false });
    input.value=''; saveTasks(); renderTasks();
}
function toggleTask(id){
    const t = tasks.find(x=>x.id===id);
    if(t){ t.completed=!t.completed; saveTasks(); renderTasks(); }
}
function deleteTask(id){
    stopTaskTimer(id,true);
    tasks = tasks.filter(t=>t.id!==id);
    saveTasks(); renderTasks();
}
function clearCompleted(){
    tasks.forEach(t=>{ if(t.completed) stopTaskTimer(t.id,true); });
    tasks = tasks.filter(t=>!t.completed);
    saveTasks(); renderTasks();
}
function setFilter(f,btn){
    currentFilter=f;
    document.querySelectorAll('.filter-btn').forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    renderTasks();
}
function escapeHtml(text){ const d=document.createElement('div'); d.appendChild(document.createTextNode(text)); return d.innerHTML; }
function formatHMS(s){
    return String(Math.floor(s/3600)).padStart(2,'0') + ':' +
           String(Math.floor((s%3600)/60)).padStart(2,'0') + ':' +
           String(s%60).padStart(2,'0');
}
function renderTasks(){
    const total=tasks.length;
    const completed=tasks.filter(t=>t.completed).length;
    document.getElementById('totalCount').textContent=total;
    document.getElementById('activeCount').textContent=total-completed;
    document.getElementById('completedCount').textContent=completed;
    let filtered=tasks;
    if(currentFilter==='active') filtered=tasks.filter(t=>!t.completed);
    if(currentFilter==='completed') filtered=tasks.filter(t=>t.completed);
    const list=document.getElementById('taskList');
    if(!filtered.length){
        list.innerHTML=`<div class="empty-state"><div class="icon">ğŸ“‹</div><p>æš‚æ— ä»»åŠ¡</p></div>`;
        return;
    }
    list.innerHTML=filtered.map(task=>`
      <li class="task-item ${task.completed?'completed':''}">
        <div class="task-checkbox" onclick="toggleTask(${task.id})"></div>
        <div class="task-text">${escapeHtml(task.text)}</div>
        <button class="btn-delete" onclick="deleteTask(${task.id})">âœ•</button>
        <div class="task-meta">
            <span class="task-time">åˆ›å»º ${task.time}</span>
            <span class="task-timer">
                â± <span id="taskTimer-${task.id}">${formatHMS(task.spentSeconds||0)}</span>
                <button onclick="toggleTaskTimer(${task.id})">${task.running?'æš‚åœ':'å¼€å§‹'}</button>
                <button onclick="resetTaskTimer(${task.id})">é‡ç½®</button>
            </span>
        </div>
      </li>
    `).join('');
}
function toggleTaskTimer(id){
    const t=tasks.find(x=>x.id===id);
    if(!t) return;
    t.running?stopTaskTimer(id):startTaskTimer(id);
    saveTasks(); renderTasks();
}
function startTaskTimer(id){
    const t=tasks.find(x=>x.id===id);
    if(!t) return;
    if(taskTimerIntervals[id]) clearInterval(taskTimerIntervals[id]);
    t.running=true;
    taskTimerIntervals[id]=setInterval(()=>{
        t.spentSeconds=(t.spentSeconds||0)+1;
        const el=document.getElementById('taskTimer-'+id);
        if(el) el.textContent=formatHMS(t.spentSeconds);
    },1000);
}
function stopTaskTimer(id,removeOnly){
    const t=tasks.find(x=>x.id===id);
    if(t && !removeOnly) t.running=false;
    if(taskTimerIntervals[id]){ clearInterval(taskTimerIntervals[id]); delete taskTimerIntervals[id]; }
}
function resetTaskTimer(id){
    const t=tasks.find(x=>x.id===id);
    if(!t) return;
    stopTaskTimer(id);
    t.spentSeconds=0; t.running=false;
    saveTasks(); renderTasks();
}
document.getElementById('taskInput').addEventListener('keydown',e=>{
    if(e.key==='Enter') addTask();
});

/* ========= ç§’è¡¨ ========= */
let swInterval=null, swSec=0;
function updateSW(){ document.getElementById('stopwatchDisplay').textContent=formatHMS(swSec); }
function startStopwatch(){ if(swInterval) clearInterval(swInterval); swInterval=setInterval(()=>{swSec++;updateSW();},1000); }
function pauseStopwatch(){ if(swInterval){clearInterval(swInterval);swInterval=null;} }
function resetStopwatch(){ pauseStopwatch(); swSec=0; updateSW(); }

/* ========= å€’è®¡æ—¶ ========= */
let cdInterval=null, cdSec=0;
function updateCD(){
    document.getElementById('countdownDisplay').textContent=
        String(Math.floor(cdSec/60)).padStart(2,'0')+':'+String(cdSec%60).padStart(2,'0');
}
function startCountdown(){
    if(cdSec===0){
        const v=parseInt(document.getElementById('countdownInput').value,10);
        if(!isNaN(v)&&v>0) cdSec=v;
    }
    if(cdSec<=0) return;
    if(cdInterval) clearInterval(cdInterval);
    cdInterval=setInterval(()=>{
        if(cdSec>0){ cdSec--; updateCD(); }
        else{ clearInterval(cdInterval); cdInterval=null; alert('â° å€’è®¡æ—¶ç»“æŸï¼'); }
    },1000);
}
function pauseCountdown(){ if(cdInterval){clearInterval(cdInterval);cdInterval=null;} }
function resetCountdown(){ pauseCountdown(); cdSec=0; updateCD(); }

/* ========= ç§‘å­¦è®¡ç®—å™¨ ========= */
const calcInputEl=document.getElementById('calcInput');
const calcResultEl=document.getElementById('calcResult');
const calcHistoryEl=document.getElementById('calcHistory');
function appendCalc(s){ calcInputEl.value+=s; calcInputEl.focus(); }
function clearCalc(){ calcInputEl.value=''; calcResultEl.value=''; }
function normalizeExpression(expr){
    expr=expr.replace(/sqrt\(/g,'Math.sqrt(')
             .replace(/ln\(/g,'Math.log(')
             .replace(/log10\(/g,'Math.log10(')
             .replace(/sin\(/g,'Math.sin(')
             .replace(/cos\(/g,'Math.cos(')
             .replace(/tan\(/g,'Math.tan(');
    while(/\^/.test(expr)){
        expr=expr.replace(/([0-9.]+|\))\s*\^\s*([0-9.]+|\()/,(_,l,r)=>'Math.pow('+l+','+r+')');
    }
    return expr;
}
function calcEqual(){
    const raw=calcInputEl.value.trim();
    if(!raw) return;
    try{
        const res=(new Function('return '+normalizeExpression(raw)))();
        if(typeof res==='number' && !isNaN(res)){
            calcResultEl.value=Number(res.toFixed(10)).toString();
            const d=document.createElement('div');
            d.textContent=raw+' = '+calcResultEl.value;
            calcHistoryEl.prepend(d);
        }else{
            calcResultEl.value='è¡¨è¾¾å¼æ— æ•ˆ';
        }
    }catch(e){ calcResultEl.value='é”™è¯¯ï¼š'+e.message; }
}
calcInputEl.addEventListener('keydown',e=>{ if(e.key==='Enter') calcEqual(); });

/* ========= å­ç½‘é¡µ Tab ========= */
function openFunPage(){
    document.getElementById('subpageOverlay').classList.add('open');
    document.body.style.overflow='hidden';
}
function closeFunPage(){
    document.getElementById('subpageOverlay').classList.remove('open');
    document.body.style.overflow='';
}
function switchSubTab(which){
    const tabQuiz=document.getElementById('tabQuiz');
    const tabCity=document.getElementById('tabCity');
    const subQuiz=document.getElementById('subTabQuiz');
    const subCity=document.getElementById('subTabCity');
    if(which==='quiz'){
        tabQuiz.classList.add('active'); tabCity.classList.remove('active');
        subQuiz.style.display='block'; subCity.style.display='none';
    }else{
        tabQuiz.classList.remove('active'); tabCity.classList.add('active');
        subQuiz.style.display='none'; subCity.style.display='block';
    }
}

/* ========= è¶£å‘³æµ‹è¯„ ========= */
const QUESTIONS=[
    {q:'ğŸŒ… ä½ å¹³æ—¶é€šå¸¸å‡ ç‚¹èµ·åºŠï¼Ÿ',opts:['5ç‚¹å‰ï¼Œæˆ‘æ˜¯è¶…çº§æ—©èµ·é¸Ÿ','6~7ç‚¹ï¼Œè§„å¾‹å¥åº·','8~9ç‚¹ï¼Œç¡åˆ°è‡ªç„¶é†’','10ç‚¹ä»¥åï¼Œä½œæ¯è‡ªç”±'],scores:[4,3,2,1]},
    {q:'ğŸ‹ï¸ ä½ æ¯å‘¨è¿åŠ¨å‡ æ¬¡ï¼Ÿ',opts:['å‡ ä¹ä¸è¿åŠ¨','å¶å°”èµ°èµ°ï¼Œ1~2æ¬¡','å›ºå®šé”»ç‚¼ 3~4æ¬¡','æ¯å¤©éƒ½ç»ƒï¼Œåœä¸ä¸‹æ¥'],scores:[1,2,3,4]},
    {q:'ğŸ¥© ä½ æœ€å¸¸åƒçš„é£Ÿç‰©ç±»å‹æ˜¯ï¼Ÿ',opts:['è”¬èœæ°´æœä¸ºä¸»','å‡è¡¡é¥®é£Ÿ','çˆ±åƒè‚‰ç±»','é«˜è›‹ç™½è¡¥å‰‚ + å¤§é‡è‚‰'],scores:[1,2,3,4]},
    {q:'ğŸ’¤ ä½ æ¯å¤©å¹³å‡ç¡å¤šå°‘å°æ—¶ï¼Ÿ',opts:['å°‘äº5å°æ—¶','5~6å°æ—¶','7~8å°æ—¶','9å°æ—¶ä»¥ä¸Š'],scores:[1,2,4,3]},
    {q:'ğŸ˜¤ é‡åˆ°æŒ«æŠ˜æ—¶ï¼Œä½ çš„ç¬¬ä¸€ååº”æ˜¯ï¼Ÿ',opts:['èººå¹³ï¼Œç­‰å®ƒè¿‡å»','æ¶ˆæä¸€æ®µæ—¶é—´å†æ¢å¤','å¾ˆå¿«è°ƒæ•´ï¼Œç»§ç»­å‰è¿›','å®Œå…¨ä¸å—å½±å“ï¼Œè¶Šæˆ˜è¶Šå‹‡'],scores:[1,2,3,4]},
    {q:'ğŸ¯ ä½ å¹³æ—¶åšäº‹çš„é£æ ¼æ˜¯ï¼Ÿ',opts:['éšæ„ï¼Œéšç¼˜','æœ‰å¤§è‡´è®¡åˆ’','è®¤çœŸè§„åˆ’æ¯ä¸€æ­¥','ç›®æ ‡å¯¼å‘ï¼Œç²¾ç¡®æ‰§è¡Œ'],scores:[1,2,3,4]},
    {q:'ğŸ§  ä½ è®¤ä¸ºè‡ªå·±çš„å­¦ä¹ èƒ½åŠ›å¦‚ä½•ï¼Ÿ',opts:['å­¦ä»€ä¹ˆéƒ½è´¹åŠ²','ä¸€èˆ¬èˆ¬','æ¯”å¤šæ•°äººå¼º','è¿‡ç›®ä¸å¿˜ï¼Œå¤©èµ‹å¼‚ç¦€'],scores:[1,2,3,4]},
    {q:'ğŸŒ ä½ æœ€æƒ³å»æ—…æ¸¸çš„åœ°æ–¹æ˜¯ï¼Ÿ',opts:['å°±åœ¨å®¶é‡Œæœ€å¥½','å›½å†…å°åŸå¸‚','å›½å†…ä¸€çº¿åŸå¸‚','å…¨çƒå„åœ°éƒ½æƒ³å»'],scores:[1,2,3,4]},
    {q:'ğŸµ ä½ å¹³æ—¶å¬ä»€ä¹ˆç±»å‹çš„éŸ³ä¹ï¼Ÿ',opts:['è½»éŸ³ä¹ / å¤å…¸','æµè¡Œ / æŠ’æƒ…','æ‘‡æ»š / è¯´å”±','ç”µå­ / é‡‘å± / æç«¯é£æ ¼'],scores:[2,2,3,4]},
    {q:'ğŸ”¥ æœ€åä¸€é¢˜ï¼šä½ è®¤ä¸ºè‡ªå·±çš„é­…åŠ›å€¼æ˜¯ï¼Ÿ',opts:['è¿˜éœ€åŠªåŠ›ï¼Œå¾ˆä¸€èˆ¬','ä¸­ç­‰ï¼Œå‡‘åˆ','ç›¸å½“ä¸é”™','é­…åŠ›çˆ†è¡¨ï¼Œæ— æ³•æŠµæŒ¡'],scores:[1,2,3,4]}
];
let currentQ=0,totalScore=0;
function startGame(){
    currentQ=0; totalScore=0;
    document.getElementById('gameIntro').style.display='none';
    document.getElementById('resultArea').style.display='none';
    document.getElementById('quizArea').style.display='block';
    renderQuestion();
}
function renderQuestion(){
    const q=QUESTIONS[currentQ];
    document.getElementById('progressBar').style.width=(currentQ/QUESTIONS.length*100)+'%';
    document.getElementById('questionNum').textContent=`ç¬¬ ${currentQ+1} / ${QUESTIONS.length} é¢˜`;
    document.getElementById('questionText').textContent=q.q;
    const area=document.getElementById('optionsArea');
    area.innerHTML=q.opts.map((opt,i)=>`<button class="opt-btn" onclick="selectAnswer(${i})">${opt}</button>`).join('');
}
function selectAnswer(i){
    totalScore+=QUESTIONS[currentQ].scores[i];
    currentQ++;
    if(currentQ<QUESTIONS.length) renderQuestion();
    else showResult();
}
function showResult(){
    document.getElementById('quizArea').style.display='none';
    document.getElementById('progressBar').style.width='100%';
    const base=8+(totalScore-10)*0.55;
    const jitter=(Math.random()*1.6-0.8);
    const raw=base+jitter;
    const size=Math.max(5,Math.min(25,raw));
    const display=size.toFixed(1);
    let emoji,level,levelColor,comment;
    if(size<10){
        emoji='ğŸŒ±'; level='S çº§ Â· ç¨€æœ‰å°ç²¾çµ'; levelColor='#4dc87a';
        comment='è™½ç„¶æ•°å€¼åå°ï¼Œä½†æµ“ç¼©çš„æ‰æ˜¯ç²¾åï¼Œå°å·§ä¹Ÿæœ‰å°å·§çš„ä¼˜åŠ¿ã€‚';
    }else if(size<14){
        emoji='ğŸ“'; level='A çº§ Â· å‡è¡¡ç¨³å¥å‹'; levelColor='#4b9de8';
        comment='ä½ å¤„åœ¨ä¸€ä¸ªç›¸å½“å‡è¡¡çš„ä½ç½®ï¼Œç¨³å¥ã€å¯é ï¼Œæ˜¯å¾ˆèˆ’æœçš„åŒºé—´ã€‚';
    }else if(size<18){
        emoji='ğŸš€'; level='S+ çº§ Â· å®åŠ›æ´¾ä»£è¡¨'; levelColor='#f5a623';
        comment='è¡¨ç°ç›¸å½“äº®çœ¼ï¼Œåœ¨ç»Ÿè®¡æ„ä¹‰ä¸Šå·²ç»ç›¸å½“é å‰ï¼Œå®åŠ›å¯è§‚ã€‚';
    }else{
        emoji='ğŸ‘‘'; level='SSS çº§ Â· ä¼ è¯´ä¸­çš„å­˜åœ¨'; levelColor='#e84393';
        comment='è¿™ä¸ªæ•°å€¼å·²ç»è¶…å‡ºäº†å¸¸è§„ç»éªŒèŒƒå›´ï¼Œåªèƒ½ç”¨â€œä¼ è¯´çº§â€æ¥å½¢å®¹ã€‚';
    }
    document.getElementById('resultEmoji').textContent=emoji;
    document.getElementById('resultSize').textContent=display+' cm';
    const levelEl=document.getElementById('resultLevel');
    levelEl.textContent=level;
    levelEl.style.background=levelColor+'22';
    levelEl.style.color=levelColor;
    document.getElementById('resultComment').textContent=comment;
    document.getElementById('formulaBlock').innerHTML =
        `<strong>ğŸ“ å°ºå¯¸æŒ‡æ•°ç®—æ³•ï¼ˆä»…ä¾›å¨±ä¹ï¼‰</strong><br>
        æ€»å¾—åˆ† S = ${totalScore} åˆ†ï¼ˆæ»¡åˆ† 40 åˆ†ï¼‰<br>
        åŸºç¡€å€¼ = 8 + (S - 10) Ã— 0.55 = ${base.toFixed(2)} cm<br>
        éšæœºæ‰°åŠ¨ Î´ = ${jitter.toFixed(2)} cmï¼ˆæ¨¡æ‹Ÿä¸ªä½“å·®å¼‚ï¼‰<br>
        æœ€ç»ˆç»“æœ = clamp(åŸºç¡€å€¼ + Î´, 5, 25) = <strong>${display} cm</strong>`;
    document.getElementById('resultArea').style.display='block';
}
function retryGame(){
    document.getElementById('resultArea').style.display='none';
    document.getElementById('gameIntro').style.display='block';
}

/* ========= ç»´å¤šåˆ©äºšåŸå¸‚æ¨¡æ‹Ÿï¼šå¤šç»“å±€ =========
   æœºåˆ¶ï¼š
   - æ—¶é—´ï¼šä» 1837 å‰åæ¨è¿›åˆ° 1901 å·¦å³ [web:69]
   - è‹¥å·¥äººæ»¡æ„ < 25 ä¸”å®‰å…¨ < 30ï¼Œå¯èƒ½è§¦å‘ã€Œå¤§ç½¢å·¥/èµ·ä¹‰äº‹ä»¶ã€[web:78]
   - è‹¥è´¢æ”¿ < 0 æˆ–é•¿æœŸè¿‡ä½ï¼Œå¯èƒ½è¢«èµ„æœ¬å¯¡å¤´æ¥ç®¡æˆ–è´¢æ”¿å´©æºƒ
   - æ³•æ¡ˆå‹æŒ‰é’®éƒ¨åˆ†åªèƒ½æ‰§è¡Œä¸€æ¬¡ï¼ˆæˆ–æœ‰å†·å´ï¼‰ï¼Œé¿å…ä¹±åˆ·
   - å¹´ä»½ >= 1901 æˆ–è§¦å‘è‡´å‘½äº‹ä»¶æ—¶ç»™å‡ºç»“å±€
========================================= */
let cityState = {
    year: 1837,
    population: 8000,
    industry: 10,
    treasury: 2000,
    happiness: 55,
    safety: 40,
    turn: 0,
    ended: false,
    endingsChecked: false
};
const oncePolicies = {
    tenHoursAct: false,
    strictPoorLawCount: 0 // å¯å¤šæ¬¡ä½†æœ‰åæœ
};

function clamp(v,min,max){ return Math.max(min,Math.min(max,v)); }

function updateCityUI(message) {
    document.getElementById('cityPopulation').textContent = cityState.population;
    document.getElementById('cityIndustry').textContent = cityState.industry;
    document.getElementById('cityTreasury').textContent = cityState.treasury;
    document.getElementById('cityYear').textContent = cityState.year;
    document.getElementById('cityHappinessText').textContent = cityState.happiness + ' / 100';
    document.getElementById('citySafetyText').textContent = cityState.safety + ' / 100';
    document.getElementById('cityHappinessBar').style.width = cityState.happiness + '%';
    document.getElementById('citySafetyBar').style.width = cityState.safety + '%';

    document.getElementById('cityYearDesc').textContent =
        `æ—¶é—´çº¿ï¼šçº¦ ${cityState.year} å¹´ Â· å·¥ä¸šåŸå¸‚æ‰©å¼ ã€å·¥äººè¿åŠ¨ä¸å¸å›½é¼ç››å¹¶å­˜çš„å¹´ä»£ã€‚`;

    // ç¦ç”¨å·²ä½¿ç”¨çš„ä¸€æ¬¡æ€§æ³•æ¡ˆ
    if (oncePolicies.tenHoursAct) {
        const btn = document.getElementById('btnTenHours');
        btn.disabled = true;
        btn.textContent = 'åå°æ—¶å·¥å‚æ³•ï¼ˆå·²å®æ–½ï¼‰';
    }

    const log = document.getElementById('cityLog');
    if(message){
        const div=document.createElement('div');
        div.className='city-log-entry';
        div.textContent = `ã€${cityState.year}ã€‘` + message;
        log.prepend(div);
    }
}

function logEvent(msg){ updateCityUI(msg); }

/* ---- æ—¶é—´æ¨è¿› ï¼‹ éšæœºäº‹ä»¶ ï¼‹ ç»“å±€æ£€æµ‹ ---- */
function advanceYears(years){
    if(cityState.ended) return;
    cityState.year += years;
    cityState.turn += 1;

    // è§¦å‘éšæœºäº‹ä»¶
    triggerRandomEvents();

    // æ¯å›åˆè‡ªç„¶å˜åŒ–ï¼šäººå£ç•¥å¢é•¿ï¼Œè´¢æ”¿éšå·¥ä¸šäº§ç”Ÿæ³¢åŠ¨
    cityState.population = Math.round(cityState.population * (1 + 0.01 * (0.5 + Math.random())));
    cityState.treasury += Math.round(cityState.industry * (0.5 + Math.random())); // ç¨å¾®äº§å‡º

    // é™åˆ¶æŒ‡æ ‡
    cityState.happiness = clamp(cityState.happiness,0,100);
    cityState.safety = clamp(cityState.safety,0,100);

    updateCityUI();

    // å¹´ä»½åˆ° 1901 æˆ–å‘ç”Ÿæç«¯çŠ¶å†µæ—¶æ£€æŸ¥ç»“å±€
    checkEndings();
}

/* ---- éšæœºäº‹ä»¶ç³»ç»Ÿ ---- */
function triggerRandomEvents(){
    // è‹¥å·²ç»ç»“æŸï¼Œä¸å†è§¦å‘
    if(cityState.ended) return;

    const r = Math.random();

    // å·¥äººä¸æ»¡ & å®‰å…¨å·®ï¼šé«˜æ¦‚ç‡è§¦å‘ç½¢å·¥/æš´åŠ¨
    if(cityState.happiness < 30 && cityState.safety < 35 && r < 0.45){
        // ä¸­å‹ç½¢å·¥äº‹ä»¶
        cityState.industry = Math.max(0, cityState.industry - 4);
        cityState.treasury -= 300;
        cityState.happiness += 5; // é€šè¿‡ç½¢å·¥å®£æ³„ï¼Œç•¥å›å‡
        logEvent('å·¥äººå¯¹é•¿å·¥æ—¶å’Œå±é™©ç¯å¢ƒä¸æ»¡ï¼Œçˆ†å‘äº†ç½¢å·¥ã€‚éƒ¨åˆ†å·¥å‚åœå·¥ï¼Œä½ è¢«è¿«ä¸å·¥äººä»£è¡¨è°ˆåˆ¤ã€‚');
    } else if (cityState.happiness < 25 && cityState.safety < 30 && r < 0.15){
        // å¤§èµ·ä¹‰ï¼šç›´æ¥è¿›å…¥ç»“å±€
        cityState.happiness = 0;
        cityState.safety = 20;
        logEvent('é•¿æœŸå‹è¿«ä¸å±é™©ç¯å¢ƒæœ€ç»ˆå¼•å‘äº†å¤§è§„æ¨¡å·¥äººèµ·ä¹‰ï¼Œè¡—å’å’Œç½¢å·¥éå¸ƒåŸå¸‚ã€‚');
        endingWorkersRevolution();
        return;
    }

    // å«ç”Ÿå·®æ—¶å¯èƒ½è§¦å‘ç–¾ç—…
    if(cityState.safety < 25 && r < 0.25){
        cityState.population = Math.round(cityState.population * 0.97);
        cityState.happiness -= 4;
        logEvent('ç”±äºæ±¡æ°´ä¸ä½æˆ¿æ¡ä»¶æ¶åŠ£ï¼Œä¸€åœºéœä¹±ç­‰ä¼ æŸ“ç—…å¸­å·åŸåŒºï¼ŒåŸå¸‚ç—…æ­»äº¡ç‡ä¸Šå‡ã€‚');
    }

    // é“è·¯ä¸å·¥ä¸šé«˜æ—¶å¯èƒ½è§¦å‘é“è·¯äº‹æ•…
    if(cityState.industry > 25 && r < 0.2){
        cityState.safety -= 5;
        cityState.treasury -= 200;
        logEvent('é“è·¯ä¸å·¥å‚è´§è¿ç¹å¿™ï¼Œå‘ç”Ÿäº†ä¸€èµ·é“è·¯äº‹æ•…ï¼Œå¼•å‘èˆ†è®ºå¯¹å®‰å…¨ä¸ç›‘ç®¡çš„æ‰¹è¯„ã€‚');
    }

    // å·¥äººæ•™è‚²è¾ƒé«˜ä¸”æ»¡æ„åº¦åä½æ—¶ï¼Œå‡ºç°æ›´å¤šæ¿€è¿›æ€æƒ³/å°å†Œå­
    if(cityState.happiness < 40 && cityState.safety > 45 && r < 0.2){
        logEvent('åœ¨å·¥äººå¤œæ ¡ä¸è¯»ä¹¦ä¼šä¸Šï¼Œä¸€äº›æ¶‰åŠå¹³ç­‰ã€å…¬æœ‰ã€å·¥äººè”åˆçš„ä¹¦è¢«é¢‘ç¹ä¼ é˜…ï¼Œæ–°çš„ç¤¾ä¼šæ€æƒ³å¼€å§‹æ¸—é€äººå¿ƒã€‚');
    }
}

/* ---- è¡ŒåŠ¨æŒ‰é’®é€»è¾‘ ---- */
// å»ºè®¾å·¥å‚ï¼šé‡å¤å¯ç”¨ï¼Œä½†ä¼šé€æ­¥å‹ä½å®‰å…¨å’Œæ»¡æ„åº¦
function buildFactory() {
    if(cityState.ended) return;
    cityState.industry += 8;
    cityState.treasury += 600;
    cityState.population += 1200;
    cityState.happiness -= 4;
    cityState.safety -= 6;
    logEvent('ä½ æ‰¹å‡†å»ºç«‹æ–°çš„çººç»‡å‚å’Œæœºæ¢°å‚ã€‚åˆ©æ¶¦ä¸Šå‡ï¼ŒåŸå¸‚å¸å¼•å¤§é‡å†œæ‘äººå£æ¶Œå…¥ï¼Œä½†åŠ ç­ä¸äº‹æ•…ä¹Ÿéšä¹‹å¢åŠ ã€‚');
    advanceYears(2);
}

// ä¿®å»ºé“è·¯ï¼šåŠ å¼ºå·¥ä¸šä¸äººå£æµåŠ¨
function expandRailway() {
    if(cityState.ended) return;
    cityState.industry += 5;
    cityState.treasury -= 400;
    cityState.population += 600;
    cityState.happiness += 2;
    logEvent('ä½ æ¨åŠ¨ä¿®å»ºé“è·¯ï¼Œå°†å·¥å‚ä¸æ¸¯å£å’ŒçŸ¿åŒºè¿é€šã€‚è´¸æ˜“ä¸äººå£æµåŠ¨æå‡ï¼Œä½†è´¢æ”¿çŸ­æœŸæ‰¿å‹ã€‚');
    advanceYears(3);
}

// åå°æ—¶å·¥å‚æ³•ï¼šä¸€æ¬¡æ€§æ³•æ¡ˆ
function passTenHoursAct() {
    if(cityState.ended) return;
    if(oncePolicies.tenHoursAct){
        logEvent('åå°æ—¶å·¥å‚æ³•å·²ç»é€šè¿‡ï¼Œæ— æ³•å†æ¬¡ç«‹æ³•ã€‚');
        return;
    }
    oncePolicies.tenHoursAct = true;
    cityState.treasury -= 150;
    cityState.happiness += 12;
    cityState.safety += 14;
    cityState.industry -= 2;
    logEvent('ä½ é€šè¿‡äº†ç±»ä¼¼ 1847 å¹´åå°æ—¶æ³•æ¡ˆçš„ç«‹æ³•ï¼Œé™åˆ¶å¦‡å¥³ä¸é’å°‘å¹´æ¯æ—¥å·¥æ—¶ï¼Œå·¥äººé˜¶çº§å¯¹ä½ å¥½æ„Ÿå¤§å¢ï¼Œéƒ¨åˆ†å‚ä¸»åˆ™æŠ±æ€¨åˆ©æ¶¦å—æŸã€‚');
    advanceYears(1);
}

// å«ç”Ÿä¸ä½æˆ¿
function improveSanitation() {
    if(cityState.ended) return;
    cityState.treasury -= 500;
    cityState.happiness += 8;
    cityState.population += 400;
    cityState.safety += 6;
    logEvent('ä½ æŠ•èµ„ä¸‹æ°´é“ã€é¥®ç”¨æ°´ç³»ç»Ÿå’Œå·¥äººä½æˆ¿ã€‚éœä¹±ç­‰æµè¡Œç—…å¾—åˆ°ä¸€å®šæ§åˆ¶ï¼Œå·¥äººå®¶åº­çš„ç”Ÿæ´»è´¨é‡æ”¹å–„ã€‚');
    advanceYears(2);
}

// æµè´«æ³•ï¼šå¯é‡å¤ï¼Œä½†æ¯æ¬¡éƒ½ä¼šå‹ä½æ»¡æ„åº¦å¹¶å¢åŠ åŠ¨è¡é£é™©
function strictPoorLaw() {
    if(cityState.ended) return;
    oncePolicies.strictPoorLawCount += 1;
    cityState.treasury += 250;
    cityState.happiness -= (6 + 2*oncePolicies.strictPoorLawCount);
    cityState.safety -= 2;
    logEvent('ä½ é€‰æ‹©ä¸¥æ ¼æ‰§è¡Œæµè´«æ³•ï¼Œå‰Šå‡æ•‘æµï¼Œè¿«ä½¿è´«æ°‘è¿›å…¥å·¥å‚ä¸æ•‘æµé™¢ã€‚è´¢æ”¿ç¼“è§£ï¼Œä½†ç¤¾ä¼šä¸æ»¡å’Œæ¿€è¿›èˆ†è®ºæ˜æ˜¾ä¸Šå‡ã€‚');
    advanceYears(1);
}

// å·¥äººå¤œæ ¡ä¸è¯»ä¹¦ä¼šï¼ˆç¤¾ä¼šä¸»ä¹‰/å…±äº§ä¸»ä¹‰èŒèŠ½å½©è›‹ï¼‰
function supportWorkersEdu() {
    if(cityState.ended) return;
    cityState.treasury -= 120;
    cityState.happiness += 7;
    cityState.safety += 3;
    cityState.industry += 1;
    logEvent('ä½ èµ„åŠ©å·¥äººå¤œæ ¡ä¸è¯»ä¹¦ä¼šã€‚ä¸€äº›å·¥äººå¼€å§‹é˜…è¯»å…³äºå·¥äººé˜¶çº§ã€å·¥ä¼šã€å…¬æœ‰åˆ¶ç­‰è‘—ä½œï¼Œè®¨è®ºã€Œè”åˆèµ·æ¥ã€ã€Œåå¯¹èµ¤è£¸å‰¥å‰Šã€çš„æ€æƒ³ï¼Œåœ¨èŒ¶é¦†ä¸å°å†Œå­ä¸­æ‚„ç„¶æ‰©æ•£ã€‚');
    advanceYears(2);
}

/* ---- ç»“å±€ç³»ç»Ÿ ---- */
function checkEndings(){
    if(cityState.ended) return;

    // è‹¥è´¢æ”¿æåº¦å´©æºƒ
    if(cityState.treasury < -1000){
        endingFiscalCollapse();
        return;
    }

    // å·¥äººé•¿æœŸæåº¦ä¸æ»¡ï¼Œä¸”å·²æœ‰å¤šæ¬¡ä¸¥è‹›æµè´«æ³•
    if(cityState.happiness <= 10 && oncePolicies.strictPoorLawCount >= 2){
        endingMobOverthrow();
        return;
    }

    // é«˜å·¥ä¸šï¼Œä½†å¹¸ç¦åº¦å’Œå®‰å…¨éƒ½æä½ï¼šè¢«èµ„æœ¬å¯¡å¤´æ§åˆ¶ä¸€åˆ‡ï¼Œå¸‚é•¿æˆå‚€å„¡
    if(cityState.industry >= 40 && cityState.happiness < 25 && cityState.safety < 30){
        endingCapitalOligarchy();
        return;
    }

    // å¹´ä»½åˆ° 1901 å·¦å³ï¼Œå¹³ç¨³ç»“æŸï¼šæ ¹æ®çŠ¶æ€ç»™å‡ºä¸åŒç»“å±€
    if(cityState.year >= 1901 && !cityState.endingsChecked){
        cityState.endingsChecked = true;
        // å®Œç¾ç»“å±€æ¡ä»¶ï¼šå·¥äººå¹¸ç¦ >= 65ï¼Œå®‰å…¨ >= 60ï¼Œè´¢æ”¿ >= 3000ï¼Œå·¥ä¸š >= 25
        if(cityState.happiness >= 65 && cityState.safety >= 60 && cityState.treasury >= 3000 && cityState.industry >= 25){
            endingPerfectMayor();
        }else if(cityState.happiness >= 45 && cityState.treasury >= 1500){
            endingOrdinaryTerm();
        }else if(cityState.happiness >= 55 && cityState.safety >= 55 && cityState.treasury <= 1000){
            // å·¥äººè¿åŠ¨æˆåŠŸã€å‘ç¤¾ä¼šä¸»ä¹‰/å…±äº§ä¸»ä¹‰å®éªŒè¿‡æ¸¡
            endingWorkersExperiment();
        }else{
            endingMediocre();
        }
    }
}

function showEnding(title, body){
    cityState.ended = true;
    // ç¦ç”¨æ‰€æœ‰æŒ‰é’®
    document.querySelectorAll('.city-btn').forEach(btn=>btn.disabled=true);
    const box=document.getElementById('cityEnding');
    box.style.display='block';
    box.innerHTML=`<strong>${title}</strong><br>${body}`;
}

// ç»“å±€ 1ï¼šæš´æ°‘æ¨ç¿»
function endingMobOverthrow(){
    showEnding(
        'ç»“å±€ï¼šè¢«æš´æ°‘æ¨ç¿»',
        'é•¿æœŸçš„é«˜å‹æµè´«æ³•ä¸ä½ç¦åˆ©æ”¿ç­–ï¼Œå åŠ å±é™©çš„å·¥å‚ç¯å¢ƒï¼Œè®©æ„¤æ€’çš„å·¥äººå’Œåº•å±‚æ°‘ä¼—æœ€ç»ˆèµ°ä¸Šè¡—å¤´ã€‚ä½ è¢«å›°åœ¨å¸‚æ”¿å…ï¼Œç›®ç¹æ€’ç«çƒ§æ¯è±¡å¾æ—§ç§©åºçš„å»ºç­‘ã€‚ä½ ä½œä¸ºå¸‚é•¿è¢«è¿«æµäº¡ï¼Œç•™ä¸‹çš„æ˜¯ä¸€åº§åœ¨çƒˆç«ä¸­é‡å¡‘çš„åŸå¸‚ã€‚'
    );
}

// ç»“å±€ 2ï¼šè´¢æ”¿å´©æºƒ
function endingFiscalCollapse(){
    showEnding(
        'ç»“å±€ï¼šè´¢æ”¿å´©æºƒï¼ŒåŸå¸‚ç ´äº§',
        'ä½ è¿‡åº¦ä¾èµ–ä¸¾å€ºä¸çŸ­æœŸè¡Œä¸ºï¼Œè´¢æ”¿èµ¤å­—ä¸æ–­ç´¯ç§¯ï¼Œæœ€ç»ˆåŸå¸‚æ— æ³•æ”¯ä»˜å€ºåˆ¸åˆ©æ¯å’ŒåŸºç¡€æœåŠ¡æ”¯å‡ºã€‚ä¼¦æ•¦çš„æŠ¥çº¸æŠŠä½ ç§°ä¸ºâ€œæœ€ä¸è´Ÿè´£ä»»çš„å¸‚é•¿ä¹‹ä¸€â€ï¼Œä½ çš„æ”¿ç»©è¢«å½“ä½œè­¦ç¤ºæ¡ˆä¾‹å†™è¿›äº†åä¸–çš„æ•™ç§‘ä¹¦ã€‚'
    );
}

// ç»“å±€ 3ï¼šèµ„æœ¬å¯¡å¤´æ§åˆ¶
function endingCapitalOligarchy(){
    showEnding(
        'ç»“å±€ï¼šèµ„æœ¬å¯¡å¤´çš„å‚€å„¡',
        'å·¥ä¸šäº§å‡ºèŠ‚èŠ‚æ”€å‡ï¼Œä½†å·¥äººç”Ÿæ´»ä¸å®‰å…¨è¢«ä¸¥é‡ç‰ºç‰²ã€‚æœ€ç»ˆï¼ŒçœŸæ­£æŒæ¡åŸå¸‚æƒåŠ›çš„ä¸æ˜¯å¸‚æ”¿å…ï¼Œè€Œæ˜¯å‡ å®¶å·¨å‹å·¥å‚å’Œé“è·¯å…¬å¸ã€‚ä½ ä»ååœ¨å¸‚é•¿ä½ç½®ï¼Œå´åªèƒ½åœ¨è‘£äº‹ä¼šçš„æš—ç¤ºä¸æŒ‡ä»¤ä¹‹é—´å¯»æ‰¾å¾®å¼±çš„â€œè‡ªç”±è£é‡ç©ºé—´â€ã€‚'
    );
}

// ç»“å±€ 4ï¼šå·¥äººè¿åŠ¨æˆåŠŸ / ç¤¾ä¼šä¸»ä¹‰å®éªŒ
function endingWorkersExperiment(){
    showEnding(
        'ç»“å±€ï¼šå·¥äººè¿åŠ¨æˆåŠŸï¼Œæ–°çš„å®éªŒå¼€å§‹',
        'åœ¨ä½ ä»»æœŸå†…ï¼Œå·¥ä¼šé€æ¸å£®å¤§ï¼Œå·¥äººæ•™è‚²ä¸ç»„ç»‡ç¨‹åº¦æé«˜ã€‚éšç€ä¸€ç³»åˆ—è°ˆåˆ¤ã€ç½¢å·¥å’Œé€‰ä¸¾æ”¹é©ï¼Œæœ¬åŸå‡ºç°äº†å¸¦æœ‰å¼ºçƒˆå·¥äººè‡ªæ²»è‰²å½©çš„æ–°è®®ä¼šï¼Œä¸€äº›å…³é”®è¡Œä¸šè½¬ä¸ºå…¬æœ‰æˆ–åˆä½œç¤¾è¿è¥ã€‚å†å²å­¦å®¶ä¼šè¯´ï¼Œè¿™é‡Œæ›¾çŸ­æš‚å‡ºç°è¿‡ä¸€ç§å¸¦æœ‰ç¤¾ä¼šä¸»ä¹‰/å…±äº§ä¸»ä¹‰ç†æƒ³å½±å­çš„åˆ¶åº¦å®éªŒã€‚'
    );
}

// ç»“å±€ 5ï¼šå®Œç¾å¸‚é•¿ï¼Œç›†æ»¡é’µæ»¡
function endingPerfectMayor(){
    showEnding(
        'ç»“å±€ï¼šå®Œç¾å¸‚é•¿ Â· äººäººç§°é¢‚ï¼Œè‡ªå·±ä¹Ÿç›†æ»¡é’µæ»¡',
        'ä½ åœ¨å·¥ä¸šå‘å±•ã€è´¢æ”¿ç¨³å¥ä¸å·¥äººç”Ÿæ´»ä¹‹é—´æ‰¾åˆ°äº†å¾®å¦™å¹³è¡¡ï¼šåŸå¸‚é‡Œæ—¢æœ‰äº•ç„¶æœ‰åºçš„å·¥å‚ä¸é“è·¯ï¼Œä¹Ÿæœ‰ç›¸å¯¹ä½“é¢çš„ä½æˆ¿å’Œå·¥æ—¶åˆ¶åº¦ã€‚å·¥ä¼šè™½ç„¶æ´»è·ƒï¼Œå´æ›´å¤šé€šè¿‡è°ˆåˆ¤è€Œéæš´åŠ›å¯¹æŠ—ã€‚ä½ åœ¨å¸ä»»æ—¶æ—¢æ‹¥æœ‰ä¸é”™çš„ä¸ªäººè´¢å¯Œï¼Œåˆè¢«åä¸–è¯„ä»·ä¸ºâ€œå°‘è§çš„æ—¢ä¸å®Œå…¨å‘èµ„æœ¬ä½å¤´ã€ä¹Ÿæ²¡æœ‰è¢«æš´åŠ›é©å‘½åå™¬çš„å¸‚é•¿æ ·æœ¬â€ã€‚'
    );
}

// ç»“å±€ 6ï¼šå¹³å¹³æ— å¥‡çš„ä»»æœŸ
function endingOrdinaryTerm(){
    showEnding(
        'ç»“å±€ï¼šå¹³ç¨³ä»»æœŸ Â· ä¸­è§„ä¸­çŸ©',
        'ä½ çš„åŸå¸‚æ—¢æœªçˆ†å‘å¤§è§„æ¨¡èµ·ä¹‰ï¼Œä¹Ÿæ²¡æœ‰æˆä¸ºä¼ å¥‡èˆ¬çš„æ¨¡èŒƒåŸå¸‚ã€‚å·¥äººæ—¶è€ŒæŠ±æ€¨ï¼Œæ—¶è€Œæ„Ÿæ©ï¼›èµ„æœ¬å®¶æ—¶è€Œèµè®¸ï¼Œæ—¶è€Œå’’éª‚ã€‚ä½ åœ¨ 1901 å¹´å‰åæ‚„ç„¶å¸ä»»ï¼Œåå­—åªåœ¨æ—§æ¡£æ¡ˆå’Œä¸€å—ç•¥æ˜¾ç°å°˜çš„çºªå¿µç‰Œä¸Šç•™ä¸‹ç—•è¿¹ã€‚'
    );
}

// ç»“å±€ 7ï¼šæ¨¡æ£±ä¸¤å¯çš„å†å²è„šæ³¨
function endingMediocre(){
    showEnding(
        'ç»“å±€ï¼šå†å²è„šæ³¨ä¸­çš„åå­—',
        'ä½ çš„å†³ç­–æ—¶è€Œæ¨è¿›æ”¹é©ï¼Œæ—¶è€Œç´§ç¼©å¼€æ”¯ï¼Œç•™ä¸‹äº†ä¸€ä¸²å½¼æ­¤çŸ›ç›¾çš„è®°å½•ã€‚åæ¥çš„å†å²å­¦å®¶ç¿»é˜…æ¡£æ¡ˆæ—¶ï¼Œä¼šäº‰è®ºä½ ç©¶ç«Ÿæ˜¯ä¿å®ˆçš„ã€åŠ¡å®çš„ï¼Œè¿˜æ˜¯åªæ˜¯è¢«æ—¶ä»£è£¹æŒŸçš„æ™®é€šå®˜åƒšã€‚æ— è®ºå¦‚ä½•ï¼Œä½ æˆä¸ºäº†ç»´å¤šåˆ©äºšæ—¶ä»£æµ©ç€šå²ä¹¦ä¸­çš„ä¸€åˆ™è„šæ³¨ã€‚'
    );
}

/* åˆå§‹åŒ–åŸå¸‚çŠ¶æ€ä¸æ—¥å¿— */
updateCityUI('ç»´å¤šåˆ©äºšåˆšåˆšç™»åŸºï¼Œä½ è¢«ä»»å‘½ä¸ºä¸€åº§æ–°å…´å·¥ä¸šåŸå¸‚çš„å¸‚é•¿ã€‚è’¸æ±½æœºã€é“è·¯ä¸å·¥å‚æ­£åœ¨æ”¹å˜æ•´ä¸ªç¤¾ä¼šç»“æ„ã€‚');

/* åˆå§‹åŒ–å…¶ä»–æ¨¡å— */
updateSW(); updateCD(); renderTasks();
</script>
</body>
</html>
